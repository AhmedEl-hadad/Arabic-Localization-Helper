<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Arabic Localization Helper - Debug Dashboard</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        h1 {
            color: white;
            text-align: center;
            margin-bottom: 30px;
            font-size: 2.5em;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .section {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .section h2 {
            color: #667eea;
            margin-bottom: 15px;
            border-bottom: 2px solid #667eea;
            padding-bottom: 10px;
        }

        .endpoint {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            margin: 10px 0;
            border-left: 4px solid #667eea;
        }

        .endpoint code {
            background: #e9ecef;
            padding: 5px 10px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            display: block;
            margin: 10px 0;
            word-break: break-all;
        }

        .request-response {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 15px;
        }

        .request-box, .response-box {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            border: 1px solid #dee2e6;
        }

        .request-box h3 {
            color: #28a745;
            margin-bottom: 10px;
        }

        .response-box h3 {
            color: #007bff;
            margin-bottom: 10px;
        }

        pre {
            background: #2d2d2d;
            color: #f8f8f2;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            font-size: 0.9em;
            line-height: 1.5;
        }

        .log-entry {
            background: #fff;
            border-left: 4px solid #667eea;
            padding: 12px;
            margin: 8px 0;
            border-radius: 4px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .log-entry.error {
            border-left-color: #dc3545;
        }

        .log-entry.success {
            border-left-color: #28a745;
        }

        .log-entry.warning {
            border-left-color: #ffc107;
        }

        .log-meta {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 0.85em;
            color: #6c757d;
        }

        .log-location {
            font-weight: bold;
            color: #667eea;
        }

        .log-message {
            font-weight: 600;
            color: #212529;
            margin: 5px 0;
        }

        .log-data {
            background: #f8f9fa;
            padding: 8px;
            border-radius: 3px;
            margin-top: 8px;
            font-family: 'Courier New', monospace;
            font-size: 0.85em;
        }

        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .tab {
            padding: 10px 20px;
            background: #e9ecef;
            border: none;
            border-radius: 5px 5px 0 0;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }

        .tab.active {
            background: white;
            color: #667eea;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .instructions {
            background: #fff3cd;
            border: 1px solid #ffc107;
            border-radius: 5px;
            padding: 15px;
            margin-bottom: 20px;
        }

        .instructions h3 {
            color: #856404;
            margin-bottom: 10px;
        }

        .instructions ol {
            margin-left: 20px;
        }

        .instructions li {
            margin: 8px 0;
            color: #856404;
        }

        .status-badge {
            display: inline-block;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 0.8em;
            font-weight: bold;
            margin-left: 10px;
        }

        .status-online {
            background: #28a745;
            color: white;
        }

        .status-offline {
            background: #dc3545;
            color: white;
        }

        .api-endpoint {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px;
            border-radius: 5px;
            margin: 10px 0;
        }

        .api-endpoint h3 {
            margin-bottom: 10px;
        }

        .method-badge {
            display: inline-block;
            padding: 3px 8px;
            border-radius: 3px;
            font-size: 0.8em;
            font-weight: bold;
            margin-right: 10px;
        }

        .method-get {
            background: #28a745;
        }

        .method-post {
            background: #007bff;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîç Arabic Localization Helper - Debug Dashboard</h1>

        <div class="instructions">
            <h3>üìã How to Monitor Requests in Chrome DevTools</h3>
            <ol>
                <li>Open Chrome DevTools (F12 or Right-click ‚Üí Inspect)</li>
                <li>Go to the <strong>Network</strong> tab</li>
                <li>Filter by <code>127.0.0.1:7242</code> to see debug logs</li>
                <li>Filter by <code>generativelanguage.googleapis.com</code> to see Gemini API calls</li>
                <li>Click on any request to see Headers, Payload, and Response</li>
                <li>Use the <strong>Console</strong> tab to see console.log messages</li>
            </ol>
        </div>

        <div class="section">
            <h2>üåê Debug Endpoint Status</h2>
            <div class="endpoint">
                <strong>Endpoint:</strong> 
                <code>POST http://127.0.0.1:7242/ingest/e64cd474-5b87-4cea-aa55-09ab429f0d66</code>
                <span class="status-badge status-offline" id="debugStatus">OFFLINE</span>
                <p style="margin-top: 10px; color: #6c757d;">
                    This endpoint receives debug logs from the application. The server must be running to receive logs.
                </p>
            </div>
        </div>

        <div class="tabs">
            <button class="tab active" onclick="showTab('debug')">Debug Logs</button>
            <button class="tab" onclick="showTab('api')">API Requests</button>
            <button class="tab" onclick="showTab('console')">Console Logs</button>
        </div>

        <!-- Debug Logs Tab -->
        <div id="debug" class="tab-content active">
            <div class="section">
                <h2>üìù Debug Log Examples</h2>
                <p style="margin-bottom: 15px; color: #6c757d;">
                    These are example debug logs that would be sent to the debug endpoint. 
                    In Chrome DevTools Network tab, you can see actual requests when the app runs.
                </p>

                <div class="log-entry">
                    <div class="log-meta">
                        <span class="log-location">index.ts:132</span>
                        <span>Timestamp: 1703123456789</span>
                    </div>
                    <div class="log-message">handleTranslate entry</div>
                    <div class="log-data">
                        {
  "location": "index.ts:132",
  "message": "handleTranslate entry",
  "data": {
    "customProjectRoot": undefined
  },
  "timestamp": 1703123456789,
  "sessionId": "debug-session",
  "runId": "run1",
  "hypothesisId": "A"
}
                    </div>
                </div>

                <div class="log-entry success">
                    <div class="log-meta">
                        <span class="log-location">scanner.ts:59</span>
                        <span>Timestamp: 1703123457890</span>
                    </div>
                    <div class="log-message">fast-glob result</div>
                    <div class="log-data">
                        {
  "location": "scanner.ts:59",
  "message": "fast-glob result",
  "data": {
    "fileCount": 45,
    "firstFewFiles": [
      "C:\\Project\\src\\index.html",
      "C:\\Project\\src\\app.js",
      "C:\\Project\\src\\styles.css"
    ]
  },
  "timestamp": 1703123457890,
  "sessionId": "debug-session",
  "runId": "run1",
  "hypothesisId": "B"
}
                    </div>
                </div>

                <div class="log-entry">
                    <div class="log-meta">
                        <span class="log-location">translateHtml.ts:88</span>
                        <span>Timestamp: 1703123458901</span>
                    </div>
                    <div class="log-message">word translated - exact match</div>
                    <div class="log-data">
                        {
  "location": "translateHtml.ts:88",
  "message": "word translated - exact match",
  "data": {
    "word": "Welcome",
    "translation": "ŸÖÿ±ÿ≠ÿ®ÿß"
  },
  "timestamp": 1703123458901,
  "sessionId": "debug-session",
  "runId": "run1",
  "hypothesisId": "F"
}
                    </div>
                </div>

                <div class="log-entry warning">
                    <div class="log-meta">
                        <span class="log-location">translateHtml.ts:125</span>
                        <span>Timestamp: 1703123459012</span>
                    </div>
                    <div class="log-message">word NOT translated - not in dict</div>
                    <div class="log-data">
                        {
  "location": "translateHtml.ts:125",
  "message": "word NOT translated - not in dict",
  "data": {
    "word": "unknownword",
    "cleanWord": "unknownword",
    "checkedExact": false,
    "checkedLower": false,
    "checkedClean": false,
    "checkedCleanLower": false
  },
  "timestamp": 1703123459012,
  "sessionId": "debug-session",
  "runId": "run1",
  "hypothesisId": "F"
}
                    </div>
                </div>

                <div class="log-entry error">
                    <div class="log-meta">
                        <span class="log-location">scanner.ts:103</span>
                        <span>Timestamp: 1703123460123</span>
                    </div>
                    <div class="log-message">scanFiles error</div>
                    <div class="log-data">
                        {
  "location": "scanner.ts:103",
  "message": "scanFiles error",
  "data": {
    "errorMessage": "File scanning failed: EACCES: permission denied"
  },
  "timestamp": 1703123460123,
  "sessionId": "debug-session",
  "runId": "run1",
  "hypothesisId": "C"
}
                    </div>
                </div>
            </div>
        </div>

        <!-- API Requests Tab -->
        <div id="api" class="tab-content">
            <div class="section">
                <h2>üîå Gemini API Requests</h2>

                <div class="api-endpoint">
                    <h3><span class="method-badge method-get">GET</span> List Available Models</h3>
                    <code>https://generativelanguage.googleapis.com/v1beta/models?key={GEMINI_API_KEY}</code>
                    <p style="margin-top: 10px; opacity: 0.9;">
                        Optional: Discovers available Gemini models before translation
                    </p>
                </div>

                <div class="request-response">
                    <div class="request-box">
                        <h3>üì§ Request</h3>
                        <p><strong>Method:</strong> GET</p>
                        <p><strong>URL:</strong> <code>https://generativelanguage.googleapis.com/v1beta/models?key=YOUR_API_KEY</code></p>
                        <p><strong>Headers:</strong> None required</p>
                    </div>
                    <div class="response-box">
                        <h3>üì• Response</h3>
                        <pre>{
  "models": [
    {
      "name": "models/gemini-1.5-pro-latest",
      "displayName": "Gemini 1.5 Pro",
      "description": "...",
      "version": "...",
      "supportedGenerationMethods": [
        "generateContent"
      ]
    },
    {
      "name": "models/gemini-1.5-flash-latest",
      ...
    }
  ]
}</pre>
                    </div>
                </div>

                <div class="api-endpoint" style="margin-top: 30px;">
                    <h3><span class="method-badge method-post">POST</span> Generate Content (Translation)</h3>
                    <code>https://generativelanguage.googleapis.com/v1beta/models/{model}:generateContent?key={GEMINI_API_KEY}</code>
                    <p style="margin-top: 10px; opacity: 0.9;">
                        Main API call for translating missing words using AI
                    </p>
                </div>

                <div class="request-response">
                    <div class="request-box">
                        <h3>üì§ Request</h3>
                        <p><strong>Method:</strong> POST</p>
                        <p><strong>URL:</strong> <code>https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-pro-latest:generateContent?key=YOUR_API_KEY</code></p>
                        <p><strong>Headers:</strong></p>
                        <pre>Content-Type: application/json</pre>
                        <p><strong>Body:</strong></p>
                        <pre>{
  "contents": [
    {
      "parts": [
        {
          "text": "Translate these English words to Arabic. Return STRICT JSON ONLY with no explanations. Format: { \"word\": \"translated\" }.\n\nWords to translate:\n[\"Welcome\", \"Hello\", \"Goodbye\"]"
        }
      ]
    }
  ]
}</pre>
                    </div>
                    <div class="response-box">
                        <h3>üì• Response</h3>
                        <pre>{
  "candidates": [
    {
      "content": {
        "parts": [
          {
            "text": "{\n  \"Welcome\": \"ŸÖÿ±ÿ≠ÿ®ÿß\",\n  \"Hello\": \"ŸÖÿ±ÿ≠ÿ®ÿß\",\n  \"Goodbye\": \"ŸàÿØÿßÿπÿß\"\n}"
          }
        ],
        "role": "model"
      },
      "finishReason": "STOP",
      "index": 0,
      "safetyRatings": [...]
    }
  ],
  "promptFeedback": {...}
}</pre>
                    </div>
                </div>

                <div class="section" style="margin-top: 20px;">
                    <h3>üîÑ Model Fallback Sequence</h3>
                    <p>The application tries multiple models in this order:</p>
                    <ol style="margin-left: 20px; margin-top: 10px;">
                        <li>Discovered models from ListModels API</li>
                        <li>gemini-1.5-pro-latest</li>
                        <li>gemini-1.5-flash-latest</li>
                        <li>gemini-1.5-pro</li>
                        <li>gemini-1.5-flash</li>
                        <li>gemini-pro</li>
                    </ol>
                </div>
            </div>
        </div>

        <!-- Console Logs Tab -->
        <div id="console" class="tab-content">
            <div class="section">
                <h2>üí¨ Console Log Messages</h2>
                <p style="margin-bottom: 15px; color: #6c757d;">
                    These messages appear in the terminal/console when running the application.
                </p>

                <div class="log-entry success">
                    <div class="log-message">‚úì Info Messages (console.log)</div>
                    <div class="log-data">
Starting translation process...
Found 45 file(s) to translate
Pre-scanning files for missing words...
Found 12 missing word(s). Attempting AI translation...
‚úì AI translated 10 word(s). Added to dictionary.
Translating 45 file(s)...
‚úì Translated: index.html ‚Üí index-ar.html
‚úì Translated: app.js ‚Üí app-ar.js
Translation complete: 45 succeeded, 0 failed
Cache size: 234 entries
                    </div>
                </div>

                <div class="log-entry warning">
                    <div class="log-message">‚ö† Warning Messages (console.warn)</div>
                    <div class="log-data">
‚ö† Warning: 2 word(s) were requested from AI but not returned:
  - "unknownword1"
  - "unknownword2"
Gemini API returned empty response
AI translation failed: Network error. Continuing with dictionary-only mode.
                    </div>
                </div>

                <div class="log-entry error">
                    <div class="log-message">‚úó Error Messages (console.error)</div>
                    <div class="log-data">
‚úó Failed to translate C:\Project\file.js: File is outside project root
Translation failed: Error: File scanning failed
Fatal error: Unexpected error occurred
                    </div>
                </div>
            </div>
        </div>

        <div class="section">
            <h2>üìä Request Flow Diagram</h2>
            <div style="background: #f8f9fa; padding: 20px; border-radius: 5px; font-family: monospace; line-height: 2;">
                <div style="color: #667eea;">Application Start</div>
                <div style="margin-left: 20px;">‚Üì</div>
                <div style="color: #28a745;">Debug Log: handleTranslate entry</div>
                <div style="margin-left: 20px;">‚Üì</div>
                <div style="color: #28a745;">Debug Log: project root resolved</div>
                <div style="margin-left: 20px;">‚Üì</div>
                <div style="color: #28a745;">Debug Log: scanFiles entry</div>
                <div style="margin-left: 20px;">‚Üì</div>
                <div style="color: #28a745;">Debug Log: fast-glob result</div>
                <div style="margin-left: 20px;">‚Üì</div>
                <div style="color: #28a745;">Debug Log: missing words collected</div>
                <div style="margin-left: 20px;">‚Üì</div>
                <div style="color: #007bff;">API Request: GET /v1beta/models (optional)</div>
                <div style="margin-left: 20px;">‚Üì</div>
                <div style="color: #007bff;">API Request: POST /v1beta/models/{model}:generateContent</div>
                <div style="margin-left: 20px;">‚Üì</div>
                <div style="color: #28a745;">Debug Log: word translated - exact match (multiple)</div>
                <div style="margin-left: 20px;">‚Üì</div>
                <div style="color: #28a745;">Debug Log: translateFiles exit</div>
            </div>
        </div>
    </div>

    <script>
        function showTab(tabName) {
            // Hide all tab contents
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // Remove active class from all tabs
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Show selected tab content
            document.getElementById(tabName).classList.add('active');
            
            // Add active class to clicked tab
            event.target.classList.add('active');
        }

        // Check if debug server is running
        async function checkDebugServer() {
            try {
                const response = await fetch('http://127.0.0.1:7242/ingest/e64cd474-5b87-4cea-aa55-09ab429f0d66', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ test: true })
                });
                document.getElementById('debugStatus').textContent = 'ONLINE';
                document.getElementById('debugStatus').className = 'status-badge status-online';
            } catch (error) {
                document.getElementById('debugStatus').textContent = 'OFFLINE';
                document.getElementById('debugStatus').className = 'status-badge status-offline';
            }
        }

        // Check server status on load
        checkDebugServer();
        setInterval(checkDebugServer, 5000); // Check every 5 seconds
    </script>
</body>
</html>

